is.na(geih$ingtot)
sum(is.na(geih$ingtot))
load("C:/Users/Camila Cely/Documents/GitHub/ProblemSet1_Cely_Ospina/geih.Rdata")
is.na(geih$ingtot)
sum(is.na(geih$ingtot))
geih18<-geih[!(geih$age<18),] #24.568 observaciones
geih18e<-geih18[!(geih18$ocu<1),] #16.542 observaciones #ocu = 1 if occupied, 0 otherwise
is.na(geih18e$ingtot)
sum(is.na(geih18e$ingtot))
edad<-geih18e$age
educ<-geih18e$maxEducLevel
gen<-geih18e$sex
educ_time<-case_when(educ <= 1 ~ 0,
educ <= 2 ~ 1,
educ <= 3 ~ 2.5,
educ <= 4 ~ 5,
educ <= 5 ~ 7.5,
educ <= 6 ~ 12,
educ <= 7 ~ 17,
educ <= 9 ~ 0,) ##Nota, pendiente usar esto para sacar promedios e imputar valores a los que reportan ingresos de cero
exp_potencial<-edad-educ_time-5
educ_time<-case_when(educ <= 1 ~ 0,
educ <= 2 ~ 1,
educ <= 3 ~ 2.5,
educ <= 4 ~ 5,
educ <= 5 ~ 7.5,
educ <= 6 ~ 12,
educ <= 7 ~ 17,
educ <= 9 ~ 0,)
library(tidyverse)
library(rvest)
library(dplyr)
library(skimr)
educ_time<-case_when(educ <= 1 ~ 0,
educ <= 2 ~ 1,
educ <= 3 ~ 2.5,
educ <= 4 ~ 5,
educ <= 5 ~ 7.5,
educ <= 6 ~ 12,
educ <= 7 ~ 17,
educ <= 9 ~ 0,) ##No
exp_potencial<-edad-educ_time-5
summary(geih18e$ingtot)
ing<-geih18e$ingtot
edad2<-edad^2
ols1<-lm(ing~edad+edad2)
ols1
ggplot(data = geih18e , mapping = aes(x = age , y = ingtot))+
geom_point(col = "red" , size = 0.5)
summary(ols1)
library(ggplot2)
ggplot(data = geih18e , mapping = aes(x = age , y = ingtot))+
geom_point(col = "red" , size = 0.5) + stat_smooth(method= "lm", col="red")
plot(edad,ing,pch="*")
plot(edad,resid1)
resid1<-resid(ols1)
plot(edad,resid1)
ggplot(data = geih18e , mapping = aes(x = age , y = resid1))+
geom_point(col = "red" , size = 0.5)
fit1<-fitted(ols1)
par(mfrow=c(2,2))
plot(ols1)
plot(ols1)
fit1
install.packages(mosaic)
length(geih18e$age)
geih18eb<-geih18e
geih18eb$age2<-geih18eb$age^2
View(geih18eb)
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(ingtotal~age+age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
n<-length(geih18e$age) #Definir n del mismo tamaño que la muestra actual
R<-1000 #num de repeticiones
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(ingtotal~age+age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(geih_sample$ingtotal~geih_sample$age+geih_sample$age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
geih_sample
f<-lm(geih_sample$ingtotal~geih_sample$age+geih_sample$age2)
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(ingtotal~age+age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(ingtot~age+age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
eta_mod1<-rep(0,R) #vector de ceros de numero R
for(i in 1:R){
geih_sample<-sample_frac(geih18eb,size=1,replace=TRUE) #muestra del mismo tamaño que la original
f<-lm(ingtot~age+age2,geih_sample)
coefs<-f$coefficients #agarrame los coeficientes de f, o sea de la reg lineal
eta_mod1[i]<-coefs[2] #irlos reemplazando en mi vector de ceros, y el 2 corresponde al coeficiente que nos interesa, obviamente ese 2 depende del orden en que uno escribió la regresión
}
plot(hist(eta_mod1))
mean(eta_mod1)
sqrt(var(eta_mod1))
quantile(eta_mod1,c(0.025,0.975))
plot(hist(eta_mod1))
require("stargazer")
stargazer(ols1)
sqrt(var(eta_mod1))
mean(eta_mod1)
quantile(eta_mod1,c(0.025,0.975))
require("boot")
View(geih18)
eta.fn<-function(geih18eb,index){
coef(lm(ingtot~age+age2, data = geih18eb, subset = index))
}
boot(geih18eb, eta.fn, R)
coefs1<-ols1$coefficients
coefs1
b0<-coefs[1]
b1<-coefs[2]
b2<-coefs[3]
b0
b1
ols1p<-lm(geih18eb$ingtot~geih18eb$age+geih18eb$age2)
coefs1<-ols1p$coefficients
coefs1
b0<-coefs[1]
b1<-coefs[2]
b2<-coefs[3]
b0
geih_ig<-geih18e
geih_ig<-geih18e
geih_ig<-data.frame(age=runif(30,18,80))
geih_ig<- geih_ig %>% mutate(age2=age^2,
ingtot=rnorm(30,mean=12+0.06*age-0.001*age2))
reg_1<-lm(ingtot~age+age2,geih_ig)
ggplot(geih_ig , mapping = aes(x = age , y = predict(reg_1))) +
geom_point(col = "red" , size = 0.5)
ggplot(geih_ig , mapping = aes(x = age , y = predict(reg_1))) +
geom_point(col = "red" , size = 0.5)
geih_ig<-geih18e
geih_ig<-data.frame(age=runif(40,18,80))
geih_ig<- geih_ig %>% mutate(age2=age^2,
ingtot=rnorm(30,mean=12+0.06*age-0.001*age2))
reg_1<-lm(ingtot~age+age2,geih_ig)
ggplot(geih_ig , mapping = aes(x = age , y = predict(reg_1))) +
geom_point(col = "red" , size = 0.5)
geih_ig<-geih18e
geih_ig<-data.frame(age=runif(30,18,80))
geih_ig<- geih_ig %>% mutate(age2=age^2,
ingtot=rnorm(30,mean=12+0.06*age-0.001*age2))
reg_1<-lm(ingtot~age+age2,geih_ig)
ggplot(geih_ig , mapping = aes(x = age , y = predict(reg_1))) +
geom_point(col = "red" , size = 0.5)
geih_f<-geih18eb
geih_f <- geih_f %>%
mutate(sex = ifelse(test = sex > 0 ,
yes = 0,
no = 1))
summary(geih_f$sex, geih_f$fem)
geih_f<-geih18eb
geih_f <- geih_f %>%
mutate(fem = ifelse(test = sex > 0 ,
yes = 0,
no = 1))
summary(geih_f$sex, geih_f$fem)
head(geih_f$sex, geih_f$fem)
head(geih_f$fem)
head(geih_f$sex)
length(geih18$ingtot)
length(geih18e$ingtot)
summary(geih18e$ingtot)
geih_f <- geih_f %>% mutate(logingtot = log(ingtot))
head(geih_f$ingtot, geih_f$ingtot )
head(geih_f$ingtot)
head(geih_f$logingtot)
ols2<-lm(geih_f$logingtot~geih_f$fem)
is.na(geih_f$logingtot)
sum(is.na(exp_potencial))
sum(geih_f$logingtot)
sum(is.na(geih_f$logingtot))
ols2<-lm(geih_f$logingtot~geih_f$fem)
head(geih18e$sex)
head(geih18e$P6050)
stargazer(ols1)
geih_f$fem <- as.numeric(gsub("\\.", "", geih_f$fem))
ols2<-lm(geih_f$logingtot~geih_f$fem)
geih_f$logingtot <- as.numeric(gsub("\\.", "", geih_f$logingtot))
geih_f$fem <- as.numeric(gsub("\\.", "", geih_f$fem))
ols2<-lm(geih_f$logingtot~geih_f$fem)
geih_f$logingtot <- as.numeric(gsub("\\.", "", geih_f$logingtot))
ols2<-lm(geih_f$logingtot~geih_f$fem)
head(geih_f$logingtot)
